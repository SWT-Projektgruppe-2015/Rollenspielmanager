package tests.model;

import static org.junit.Assert.assertTrue;

import java.util.List;

import model.Gruppe;
import model.Spieler;

import org.junit.Before;
import org.junit.Test;

public class GruppenTest {
    private Gruppe gruppe;
    private Spieler spieler;
    
    @Before
    public void initObjects() {
        gruppe = new Gruppe();
        spieler = new Spieler();
    }
    
    
    
    @Test
    public void addSpielerToGruppeTest() {
        gruppe.addSpieler(spieler);
        assertTrue(spieler.getMembership_().contains(gruppe));
        assertTrue(gruppe.getMembers_().contains(spieler));
        gruppe.removePlayer(spieler);
    }
    
    
    
    @Test
    public void removeSpielerFromGruppeTest() {
        gruppe.addSpieler(spieler);
        gruppe.removePlayer(spieler);
        assertTrue(!spieler.getMembership_().contains(gruppe));
        assertTrue(!gruppe.getMembers_().contains(spieler));
    }
    
    
    
    @Test
    public void deleteSpielerFromDB() {
        gruppe.addToDB();
        spieler.addToDB();
        
        gruppe.addSpieler(spieler);
        spieler.deleteFromDB();
        
        assertTrue(!gruppe.getMembers_().contains(spieler));
        
        gruppe.deleteFromDB();
    }
    
    
    
    @Test
    public void correctOrderWithSamePrefix() {
        Gruppe firstGruppe = new Gruppe();
        firstGruppe.setName_("Abenteuer");
        Gruppe secondGruppe = new Gruppe();
        secondGruppe.setName_("Abenteuer in Cysteron");
        
        assertTrue(firstGruppe.compareTo(secondGruppe) < 0);
    }
    
    
    
    @Test
    public void correctOrderWithDifferentPrefix() {
        Gruppe firstGruppe = new Gruppe();
        firstGruppe.setName_("Abenteuer");
        Gruppe secondGruppe = new Gruppe();
        secondGruppe.setName_("Buben");
        
        assertTrue(firstGruppe.compareTo(secondGruppe) < 0);
    }
    
    
    @Test
    public void getAllTest() {
        gruppe.addToDB();
        List<Gruppe> allGruppen = Gruppe.getAll();
        assertTrue(allGruppen.contains(gruppe));
        gruppe.deleteFromDB();
    }
    
    
    @Test
    public void correctOrderInMemberList() {
        gruppe.addToDB();
        Spieler firstSpieler = new Spieler();
        firstSpieler.setName_("Anna");
        Spieler secondSpieler = new Spieler();
        secondSpieler.setName_("Bert");
        gruppe.addSpieler(secondSpieler);
        gruppe.addSpieler(firstSpieler);
        
        List<Spieler> orderedMembers = gruppe.getOrderedMemberList();
        assertTrue(orderedMembers.get(0) == firstSpieler);
        assertTrue(orderedMembers.get(1) == secondSpieler);
        
        gruppe.deleteFromDB();
    }
}
